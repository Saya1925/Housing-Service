<!DOCTYPE html>
<html>

<head>
    <title>Task Selecting Panel</title>
    <link rel="stylesheet" href="style_selectPanel.css">
</head>

<body>
    <span id="sharedDiv">
        <span><u>here are the localStorage session data:</u></span><br>
        <span id="displayStoredSession"></span>
    </span>
    <br><br><br>

    <button id="byLatestButton">by Latest</button><br>
    <br>
    <div class="selectPanel-wrapper">
        <div id="selectPanelContainer" class="selectPanel-container"></div>
    </div>

    <br>
    <br>
    <!-- <span id="raw_offerListDisplay"></span> -->

    <!-- 
    <div id="offerListPanel">
        <div id="offerContainer" class="offer-container">
            <table class="offerContainer">
                <tr>
                    <td>
                    <td style="width: 145px; vertical-align: top; text-align: right; padding: 10px;">
                        <span id="userName">placeholder</span><br>
                        <span id="rating">placeholder</span>
                    </td>
                    <td style="width: 455px; vertical-align: top; padding: 10px; background-color: #FFFFFF;">
                        <span id="message">placeholder</span>
                    </td>
                    </td>
                </tr>
            </table>
        </div>
    </div> -->

    <script>
        const byLatestButton = document.getElementById('byLatestButton');
        const selectPanelContainer = document.getElementById('selectPanelContainer');

        byLatestButton.addEventListener('click', async () => {
            loadSelectPanel();
        });
        document.addEventListener('DOMContentLoaded', () => {
            loadSelectPanel();
        });

        function loadSelectPanel() {
            fetch('/getTask/byLatest')
                .then(response => response.json())
                .then(tasks => {
                    // Clear previous tables
                    selectPanelContainer.innerHTML = '';
                    selectPanelContainer.classList.add('selectPanel-container');

                    // Create a table for each task
                    tasks.forEach(task => {
                        const table = document.createElement('table');
                        const row1 = table.insertRow();
                        const row2 = table.insertRow();
                        const row3 = table.insertRow();
                        const row4 = table.insertRow();

                        // Row 1: Task Name (bold, font size 24px)
                        const cell1 = row1.insertCell();
                        cell1.textContent = task.taskName;
                        cell1.classList.add('task-name');

                        // Row 2: Start Date
                        const cell2 = row2.insertCell();
                        cell2.textContent = task.startDate;
                        cell2.classList.add('start-date');

                        // Row 3: Location
                        const cell3 = row3.insertCell();
                        cell3.textContent = task.location;
                        cell3.classList.add('location');

                        // Row 4: Budget and Task ID (split into two columns)
                        const cell4_1 = row4.insertCell();
                        const cell4_2 = row4.insertCell();
                        cell4_1.textContent = task.budget;
                        cell4_1.classList.add('budget');
                        cell4_2.textContent = "#000" + task.taskID;
                        cell4_2.classList.add('task-id');

                        // Add click event listener to each table
                        table.addEventListener('click', () => {
                            localStorage.setItem('targetTaskID', task.taskID);
                            console.log(localStorage.getItem('targetTaskID'));
                            // Perform any other actions upon table click if needed
                        });

                        // Add the table to the tables container
                        selectPanelContainer.appendChild(table);
                    });
                })
                .catch(error => {
                    console.error(error);
                });
        }
    </script>



    <script>
        function updateDisplayedSession() {
            const userName = localStorage.getItem('userName');
            const userID = localStorage.getItem('userID');
            const displayElement = document.getElementById('displayStoredSession');
            displayElement.textContent = `User Name: ${userName} | UserID: ${userID}`;
        }
        // Initial display of stored session information
        updateDisplayedSession();
    // // Wait for the sharedDiv to be inserted into the container
    // document.addEventListener('DOMContentLoaded', updateDisplayedSession);
    </script>
</body>

</html>